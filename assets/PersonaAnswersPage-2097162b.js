import{d as V,c as o,o as f,a as p,b as r,i as P,u as l,y as b,m as z,D as E,F as N,j as D,e as $,t as I,G as Z,H as ee,f as se,g as te,v as B,p as O,w as Q,h as ne,I as R,x as ae,E as oe,J as k,K as T,L as re,r as le,l as ce,q as ie,s as ue,_ as he}from"./index-ab09fbd8.js";import{S as fe,_ as de}from"./PageContainer.vue_vue_type_style_index_0_lang-14051f18.js";const pe=""+new URL("persona-answers-5f4217e2.webp",import.meta.url).href,ve={class:"question-sign"},Se=r("p",{class:"instruction"}," Read the question on this shape ",-1),_e={class:"shape"},ge={class:"answers"},me=r("img",{class:"circles",src:pe},null,-1),we={class:"texts"},xe=["onClick"],ye=V({__name:"PersonaStepSet",props:{historyStep:null,idxOffset:{default:0},stepState:{default:"question"},onNext:{type:Function,default:()=>{}},onSelect:null,isLast:{type:Boolean,default:!1}},setup(a){const q=a,i=o(()=>Z[q.historyStep.answerSet.question]),x=o(()=>ee([...q.historyStep.answerSet.answers]));return(u,M)=>(f(),p("div",{class:$(["step-set",a.idxOffset?a.idxOffset==1?"next-1 question-state":a.idxOffset==-1?"prev-1 answers-state":!1:"active "+a.stepState+"-state",a.isLast?"last":""])},[r("div",ve,[Se,r("div",_e,[P(fe,{src:"persona-shapes.webp","x-sprites":2,"y-sprites":3,x:l(i).x,y:l(i).y},null,8,["x","y"])]),P(E,{class:"cta",onClick:a.onNext},{default:b(()=>[z(" Continue ")]),_:1},8,["onClick"])]),r("div",ge,[me,r("div",we,[(f(!0),p(N,null,D(l(x),(c,v)=>(f(),p("div",{key:v,class:$(["answer",v%2==0?"even":"odd"])},[r("p",{onClick:S=>a.onSelect(c)},I(c.text),9,xe)],2))),128))])])],2))}});const Ae=a=>(ie("data-v-8f2e233a"),a=a(),ue(),a),Be={class:"persona-answers"},Pe={class:"number current"},qe={class:"current"},Ce={class:"all"},ke=Ae(()=>r("p",{class:"instruction"}," Finished in the Bright Room ",-1)),be=V({__name:"PersonaAnswersPage",setup(a){const i=se(),x=te(),u=B(i.progress.personaHistory),M=o(()=>{const e={};return u.value.map(n=>e[n.answerSet.id]=!0),e}),c=o(()=>u.value.length),v=o(()=>u.value[c.value-1]||null),S=B("question"),_=o(()=>S.value=="question"&&c.value==k+1),y=o(()=>{let e=0,n=T[e];for(;c.value>n.until;)e++,n=T[e];return n}),H=o(()=>i.progress.personaScoresSum),g=B([]);for(let e=0;e<O.length;e++){const n=O[e].id;g.value.push({arch:n,score:H.value[n]||0,idx:e})}const m=o(()=>{const e=y.value.focusBetween;for(let s=0;s<g.value.length;s++){const t=g.value[s];t.score=H.value[t.arch]||0}const n=[...g.value];return n.sort((s,t)=>s.score==t.score?Math.random()-.5:s.score>t.score?-1:1),n.slice(0,e)}),L=o(()=>{let e=0;const n=m.value;for(let s=0;s<n.length;s++){const t=n[s];e+=t.score}return e/=n.length,n.filter(s=>s.score<e).sort((s,t)=>s.idx<t.idx?-1:1)}),w=o(()=>(m.value.length==g.value.length,re.filter(n=>!(n.question==J.value||M.value[n.id])))),d=B([]);function j(){d.value=[...w.value],y.value.contrastMult&&(y.value.contrastMult>0?d.value.sort((s,t)=>s.contrast<t.contrast?1:-1):y.value.contrastMult<0&&d.value.sort((s,t)=>s.contrast>t.contrast?1:-1));for(let s=0;s<w.value.length;s++){const t=w.value[s];t.fitness=0;for(let h=0;h<m.value.length;h++){const A=m.value[h];t.fitness+=(t.sumScores[A.arch]||0)*-A.score}}d.value.sort((s,t)=>s.fitness>t.fitness?-1:1);const e=L.value.length>1?L.value:m.value;if(e.length>1){for(let s=0;s<w.value.length;s++){const t=w.value[s];if(t.fitness=0,e.length)for(let h=0;h<e.length;h++){const A=e[h].arch,G=t.contrasts[A];if(G)for(let C=0;C<e.length;C++){const X=e[C].arch;t.fitness+=G[X]||0}}}d.value.sort((s,t)=>s.fitness>t.fitness?-1:1)}const n=d.value[0];n&&i.addPersonaStep({answerSet:n})}const J=o(()=>u.value.length?u.value[u.value.length-1].answerSet.question:null),K=o(()=>!_.value&&(!v.value||!!v.value.selectedScores));Q(K,(e,n)=>{e!=n&&e&&j()},{immediate:!0});function U(){S.value="answers"}function Y(e){i.selectPersonaAnswer(e.scores),S.value="question"}function W(){i.selectPersona(),le.replace({name:ce.PersonaToSideRoom})}Q(_,(e,n)=>{e!=n&&F()},{immediate:!0}),ne(()=>F(!0));function F(e=!1){_.value?setTimeout(()=>{x.setBGSetting({logoSize:.5,headerY:.5})},e?0:800):x.setBGSetting({})}return(e,n)=>(f(),p("div",Be,[r("div",{class:"steps-container",style:R({top:"-"+(l(c)-1)*1.5*100+"vh"})},[(f(!0),p(N,null,D(l(i).progress.personaHistory,(s,t)=>(f(),p(N,null,[Math.abs(l(c)-(t+1))<=1?(f(),ae(ye,{key:t,"history-step":s,"idx-offset":t-l(c)+1,"step-state":S.value,"on-next":U,"on-select":Y,"is-last":l(_),style:R({top:t*1.5*100+"vh"})},null,8,["history-step","idx-offset","step-state","is-last","style"])):oe("",!0)],64))),256))],4),r("div",{class:$(["others",{last:l(_)}])},[r("div",Pe,[r("span",qe,I(Math.min(l(c),l(k))),1),r("span",Ce,"/"+I(l(k)),1)]),P(de,{"outer-class":{closing:!0}},{default:b(()=>[ke,P(E,{class:"cta",onClick:W},{default:b(()=>[z(" Continue ")]),_:1})]),_:1})],2)]))}});const Ie=he(be,[["__scopeId","data-v-8f2e233a"]]);export{Ie as default};
